{"version":3,"sources":["main.min.js","main.js"],"names":["drawFFT","values","fftContext","clearRect","canvasWidth","canvasHeight","barWidth","fft","size","i","len","length","x","y","fillStyle","fillRect","drawWaveform","waveContext","beginPath","lineJoin","lineWidth","strokeStyle","waveformGradient","moveTo","val","lineTo","stroke","drawMeter","level","meter","getLevel","gain","Tone","dbToGain","meterContext","meterGradient","sizeCanvases","$","width","height","canvas","createLinearGradient","addColorStop","loop","requestAnimationFrame","fftValues","getValue","waveformValues","waveform","FFT","Waveform","Meter","player","Player","url","fan","toMaster","toggleButtom","document","getElementById","addEventListener","volume","value","start","seek","id","appendTo","get","getContext","window","resize"],"mappings":"AAAA,YC+BA,SAASA,SAAQC,GACfC,WAAWC,UAAU,EAAG,EAAGC,YAAaC,aAExC,KAAK,GADDC,GAAWF,YAAcG,IAAIC,KACxBC,EAAI,EAAGC,EAAMT,EAAOU,OAAQF,EAAIC,EAAKD,IAAI,CAChD,GAAIG,GAAIR,aAAeK,EAAIC,GACvBG,EAAuB,IAAlBZ,EAAOQ,GAAK,GACrBP,YAAWY,UAAY,sBAAwBL,EAAEC,EAAM,IACvDR,WAAWa,SAASH,EAAGP,aAAeQ,EAAGP,EAAUD,eAQvD,QAASW,cAAaf,GAEpBgB,YAAYd,UAAU,EAAG,EAAGC,YAAaC,cACzCY,YAAYC,YACZD,YAAYE,SAAW,QACvBF,YAAYG,UAAY,EACxBH,YAAYI,YAAcC,iBAC1BL,YAAYM,OAAO,EAAItB,EAAO,GAAK,IAAOI,aAC1C,KAAK,GAAII,GAAI,EAAGC,EAAMT,EAAOU,OAAQF,EAAIC,EAAKD,IAAI,CAChD,GAAIe,IAAOvB,EAAOQ,GAAK,GAAK,EACxBG,EAAIR,aAAeK,EAAIC,GACvBG,EAAIW,EAAMnB,YACdY,aAAYQ,OAAOb,EAAGC,GAExBI,YAAYS,SAQd,QAASC,aACP,GAAMC,GAAQC,MAAMC,WACdC,EAAOC,KAAKC,SAASL,EAE3BM,cAAa/B,UAAU,EAAG,EAAGC,YAAaC,cAC1C6B,aAAapB,UAAYqB,cACzBD,aAAanB,SAAS,EAAG,EAAGX,YAAaC,cACzC6B,aAAapB,UAAY,UACzBoB,aAAanB,SAASX,YAAc2B,EAAM,EAAG3B,YAAaC,cAK5D,QAAS+B,gBACPhC,YAAciC,EAAE,QAAQC,QACxBjC,aAAegC,EAAE,QAAQE,SACzBtB,YAAYuB,OAAOF,MAAQlC,YAC3BF,WAAWsC,OAAOF,MAAQlC,YAC1Ba,YAAYuB,OAAOD,OAASlC,aAC5BH,WAAWsC,OAAOD,OAASlC,aAC3B6B,aAAaM,OAAOF,MAAQlC,YAC5B8B,aAAaM,OAAOD,OAASlC,aAE7B8B,cAAgBD,aAAaO,qBAAqB,EAAG,EAAGrC,YAAaC,cACrE8B,cAAcO,aAAa,EAAG,WAC9BP,cAAcO,aAAa,EAAG,WAE9BpB,iBAAmBL,YAAYwB,qBAAqB,EAAG,EAAGrC,YAAaC,cACvEiB,iBAAiBoB,aAAa,EAAG,WACjCpB,iBAAiBoB,aAAa,EAAG,WAInC,QAASC,QACPC,sBAAsBD,KAEtB,IAAIE,GAAYtC,IAAIuC,UACpB9C,SAAQ6C,EAER,IAAIE,GAAiBC,SAASF,UAC9B9B,cAAa+B,GAEbpB,YA5GF,GAAIpB,KAAM,GAAIyB,MAAKiB,IAAI,MAEnBD,SAAW,GAAIhB,MAAKkB,SAAS,MAG7BrB,MAAQ,GAAIG,MAAKmB,MAAM,GAIvBC,OAAS,GAAIpB,MAAKqB,QACpBC,IAAQ,0BACRX,MAAS,IAEVY,IAAIhD,IAAKyC,SAAUnB,OACnB2B,WAGKC,aAAeC,SAASC,eAAe,aAC7CF,cAAaG,iBAAiB,QAAU,WACtCR,OAAOS,OAAOC,UACdV,OAAOW,QACPX,OAAOY,KAAK,MAId,IAAI9D,YAAamC,EAAE,YACjB4B,GAAO,QACNC,SAAS,QAAQC,IAAI,GAAGC,WAAW,MAalCnD,YAAcoB,EAAE,YAClB4B,GAAO,aACNC,SAAS,QAAQC,IAAI,GAAGC,WAAW,MAClC9C,iBAmBAY,aAAeG,EAAE,YACnB4B,GAAO,QACNC,SAAS,QAAQC,IAAI,GAAGC,WAAW,MAClCjC,cAaA/B,YAAaC,YAmBjB+B,gBACAC,EAAEgC,QAAQC,OAAOlC,cAYjBO","file":"main.min.js","sourcesContent":["\"use strict\";\n//analyse the frequency/amplitude of the incoming signal\nvar fft = new Tone.FFT(1024);\n//get the waveform data for the audio\nvar waveform = new Tone.Waveform(1024);\n\n//create a level meter\nvar meter = new Tone.Meter(0.0);\n\n\n\nvar player = new Tone.Player({\n  \"url\": \"media/all_the_stars.mp3\",\n  \"loop\": true }).\n\nfan(fft, waveform, meter).\ntoMaster();\n\n\nvar toggleButtom = document.getElementById('btn_toggle');\ntoggleButtom.addEventListener('click', function () {\n  player.volume.value = -12;\n  player.start();\n  player.seek(130);\n});\n\n//drawing the FFT\nvar fftContext = $(\"<canvas>\", {\n  \"id\": \"fft\" }).\nappendTo(\"body\").get(0).getContext(\"2d\");\n\nfunction drawFFT(values) {\n  fftContext.clearRect(0, 0, canvasWidth, canvasHeight);\n  var barWidth = canvasWidth / fft.size;\n  for (var i = 0, len = values.length; i < len; i++) {\n    var x = canvasWidth * (i / len);\n    var y = (values[i] + 80) * 10;\n    fftContext.fillStyle = \"rgba(156, 39, 176, \" + i / len + \")\";\n    fftContext.fillRect(x, canvasHeight - y, barWidth, canvasHeight);\n  }\n}\n//the waveform data\nvar waveContext = $(\"<canvas>\", {\n  \"id\": \"waveform\" }).\nappendTo(\"body\").get(0).getContext(\"2d\");\nvar waveformGradient;\nfunction drawWaveform(values) {\n  //draw the waveform\n  waveContext.clearRect(0, 0, canvasWidth, canvasHeight);\n  waveContext.beginPath();\n  waveContext.lineJoin = \"round\";\n  waveContext.lineWidth = 6;\n  waveContext.strokeStyle = waveformGradient;\n  waveContext.moveTo(0, values[0] / 255 * canvasHeight);\n  for (var i = 1, len = values.length; i < len; i++) {\n    var val = (values[i] + 1) / 2;\n    var x = canvasWidth * (i / len);\n    var y = val * canvasHeight;\n    waveContext.lineTo(x, y);\n  }\n  waveContext.stroke();\n}\n\n//drawing the FFT\nvar meterContext = $(\"<canvas>\", {\n  \"id\": \"fft\" }).\nappendTo(\"body\").get(0).getContext(\"2d\");\nvar meterGradient;\nfunction drawMeter() {\n  var level = meter.getLevel();\n  var gain = Tone.dbToGain(level); //scale it between 0 - 1\n  // console.log(level);\n  meterContext.clearRect(0, 0, canvasWidth, canvasHeight);\n  meterContext.fillStyle = meterGradient;\n  meterContext.fillRect(0, 0, canvasWidth, canvasHeight);\n  meterContext.fillStyle = \"#212121\";\n  meterContext.fillRect(canvasWidth * gain, 0, canvasWidth, canvasHeight);\n}\n\n//size the canvases\nvar canvasWidth, canvasHeight;\nfunction sizeCanvases() {\n  canvasWidth = $(\"#fft\").width();\n  canvasHeight = $(\"#fft\").height();\n  waveContext.canvas.width = canvasWidth;\n  fftContext.canvas.width = canvasWidth;\n  waveContext.canvas.height = canvasHeight;\n  fftContext.canvas.height = canvasHeight;\n  meterContext.canvas.width = canvasWidth;\n  meterContext.canvas.height = canvasHeight;\n  //make the meter gradient\n  meterGradient = meterContext.createLinearGradient(0, 0, canvasWidth, canvasHeight);\n  meterGradient.addColorStop(0, \"#4A148C\");\n  meterGradient.addColorStop(1, \"#D500F9\");\n  //make the gradient\n  waveformGradient = waveContext.createLinearGradient(0, 0, canvasWidth, canvasHeight);\n  waveformGradient.addColorStop(0, \"#4A148C\");\n  waveformGradient.addColorStop(1, \"#D500F9\");\n}\nsizeCanvases();\n$(window).resize(sizeCanvases);\nfunction loop() {\n  requestAnimationFrame(loop);\n  //get the fft data and draw it\n  var fftValues = fft.getValue();\n  drawFFT(fftValues);\n  //get the waveform values and draw it\n  var waveformValues = waveform.getValue();\n  drawWaveform(waveformValues);\n\n  drawMeter();\n}\nloop();\n//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsiZmZ0IiwiVG9uZSIsIkZGVCIsIndhdmVmb3JtIiwiV2F2ZWZvcm0iLCJtZXRlciIsIk1ldGVyIiwicGxheWVyIiwiUGxheWVyIiwiZmFuIiwidG9NYXN0ZXIiLCJ0b2dnbGVCdXR0b20iLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiYWRkRXZlbnRMaXN0ZW5lciIsInZvbHVtZSIsInZhbHVlIiwic3RhcnQiLCJzZWVrIiwiZmZ0Q29udGV4dCIsIiQiLCJhcHBlbmRUbyIsImdldCIsImdldENvbnRleHQiLCJkcmF3RkZUIiwidmFsdWVzIiwiY2xlYXJSZWN0IiwiY2FudmFzV2lkdGgiLCJjYW52YXNIZWlnaHQiLCJiYXJXaWR0aCIsInNpemUiLCJpIiwibGVuIiwibGVuZ3RoIiwieCIsInkiLCJmaWxsU3R5bGUiLCJmaWxsUmVjdCIsIndhdmVDb250ZXh0Iiwid2F2ZWZvcm1HcmFkaWVudCIsImRyYXdXYXZlZm9ybSIsImJlZ2luUGF0aCIsImxpbmVKb2luIiwibGluZVdpZHRoIiwic3Ryb2tlU3R5bGUiLCJtb3ZlVG8iLCJ2YWwiLCJsaW5lVG8iLCJzdHJva2UiLCJtZXRlckNvbnRleHQiLCJtZXRlckdyYWRpZW50IiwiZHJhd01ldGVyIiwibGV2ZWwiLCJnZXRMZXZlbCIsImdhaW4iLCJkYlRvR2FpbiIsInNpemVDYW52YXNlcyIsIndpZHRoIiwiaGVpZ2h0IiwiY2FudmFzIiwiY3JlYXRlTGluZWFyR3JhZGllbnQiLCJhZGRDb2xvclN0b3AiLCJ3aW5kb3ciLCJyZXNpemUiLCJsb29wIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiZmZ0VmFsdWVzIiwiZ2V0VmFsdWUiLCJ3YXZlZm9ybVZhbHVlcyJdLCJtYXBwaW5ncyI6IjtBQUNBO0FBQ0EsSUFBSUEsTUFBTSxJQUFJQyxLQUFLQyxHQUFULENBQWEsSUFBYixDQUFWO0FBQ0E7QUFDQSxJQUFJQyxXQUFXLElBQUlGLEtBQUtHLFFBQVQsQ0FBa0IsSUFBbEIs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YixDQUFrQyxDQUFsQyxFQUFxQyxDQUFyQyxFQUF3Q2pDLFdBQXhDLEVBQXFEQyxZQUFyRCxDQUFoQjtBQUNBc0IsZ0JBQWNXLFlBQWQsQ0FBMkIsQ0FBM0IsRUFBOEIsU0FBOUI7QUFDQVgsZ0JBQWNXLFlBQWQsQ0FBMkIsQ0FBM0IsRUFBOEIsU0FBOUI7QUFDQTtBQUNBdEIscUJBQW1CRCxZQUFZc0Isb0JBQVosQ0FBaUMsQ0FBakMsRUFBb0MsQ0FBcEMsRUFBdUNqQyxXQUF2QyxFQUFvREMsWUFBcEQsQ0FBbkI7QUFDQVcsbUJBQWlCc0IsWUFBakIsQ0FBOEIsQ0FBOUIsRUFBaUMsU0FBakM7QUFDQXRCLG1CQUFpQnNCLFlBQWpCLENBQThCLENBQTlCLEVBQWlDLFNBQWpDO0FBQ0Q7QUFDREw7QUFDQXBDLEVBQUUwQyxNQUFGLEVBQVVDLE1BQVYsQ0FBaUJQLFlBQWpCO0FBQ0EsU0FBU1EsSUFBVCxHQUFlO0FBQ2JDLHdCQUFzQkQsSUFBdEI7QUFDQTtBQUNBLE1BQUlFLFlBQVlsRSxJQUFJbUUsUUFBSixFQUFoQjtBQUNBM0MsVUFBUTBDLFNBQVI7QUFDQTtBQUNBLE1BQUlFLGlCQUFpQmpFLFNBQVNnRSxRQUFULEVBQXJCO0FBQ0EzQixlQUFhNEIsY0FBYjs7QUFFQWpCO0FBQ0Q7QUFDRGEiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuLy9hbmFseXNlIHRoZSBmcmVxdWVuY3kvYW1wbGl0dWRlIG9mIHRoZSBpbmNvbWluZyBzaWduYWxcbnZhciBmZnQgPSBuZXcgVG9uZS5GRlQoMTAyNCk7XG4vL2dldCB0aGUgd2F2ZWZvcm0gZGF0YSBmb3IgdGhlIGF1ZGlvXG52YXIgd2F2ZWZvcm0gPSBuZXcgVG9uZS5XYXZlZm9ybSgxMDI0KTtcblxuLy9jcmVhdGUgYSBsZXZlbCBtZXRlclxudmFyIG1ldGVyID0gbmV3IFRvbmUuTWV0ZXIoMC4wKTtcblxuXG5cbnZhciBwbGF5ZXIgPSBuZXcgVG9uZS5QbGF5ZXIoe1xuICBcInVybFwiIDogXCJtZWRpYS9hbGxfdGhlX3N0YXJzLm1wM1wiLFxuICBcImxvb3BcIiA6IHRydWVcbn0pXG4uZmFuKGZmdCwgd2F2ZWZvcm0sIG1ldGVyKVxuLnRvTWFzdGVyKCk7XG5cblxuY29uc3QgdG9nZ2xlQnV0dG9tID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bl90b2dnbGUnKTtcbnRvZ2dsZUJ1dHRvbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICAoKSA9PiB7XG4gIHBsYXllci52b2x1bWUudmFsdWUgPSAtMTI7XG4gIHBsYXllci5zdGFydCgpO1xuICBwbGF5ZXIuc2VlaygxMzApO1xufSk7XG5cbi8vZHJhd2luZyB0aGUgRkZUXG52YXIgZmZ0Q29udGV4dCA9ICQoXCI8Y2FudmFzPlwiLHtcbiAgXCJpZFwiIDogXCJmZnRcIlxufSkuYXBwZW5kVG8oXCJib2R5XCIpLmdldCgwKS5nZXRDb250ZXh0KFwiMmRcIik7XG5cbmZ1bmN0aW9uIGRyYXdGRlQodmFsdWVzKXtcbiAgZmZ0Q29udGV4dC5jbGVhclJlY3QoMCwgMCwgY2FudmFzV2lkdGgsIGNhbnZhc0hlaWdodCk7XG4gIHZhciBiYXJXaWR0aCA9IGNhbnZhc1dpZHRoIC8gZmZ0LnNpemU7XG4gIGZvciAodmFyIGkgPSAwLCBsZW4gPSB2YWx1ZXMubGVuZ3RoOyBpIDwgbGVuOyBpKyspe1xuICAgIHZhciB4ID0gY2FudmFzV2lkdGggKiAoaSAvIGxlbik7XG4gICAgdmFyIHkgPSAodmFsdWVzW2ldICsgODApICogMTA7XG4gICAgZmZ0Q29udGV4dC5maWxsU3R5bGUgPSBcInJnYmEoMTU2LCAzOSwgMTc2LCBcIiArIGkvbGVuICsgXCIpXCI7XG4gICAgZmZ0Q29udGV4dC5maWxsUmVjdCh4LCBjYW52YXNIZWlnaHQgLSB5LCBiYXJXaWR0aCwgY2FudmFzSGVpZ2h0KTtcbiAgfVxufVxuLy90aGUgd2F2ZWZvcm0gZGF0YVxudmFyIHdhdmVDb250ZXh0ID0gJChcIjxjYW52YXM+XCIsIHtcbiAgXCJpZFwiIDogXCJ3YXZlZm9ybVwiXG59KS5hcHBlbmRUbyhcImJvZHlcIikuZ2V0KDApLmdldENvbnRleHQoXCIyZFwiKTtcbnZhciB3YXZlZm9ybUdyYWRpZW50O1xuZnVuY3Rpb24gZHJhd1dhdmVmb3JtKHZhbHVlcyl7XG4gIC8vZHJhdyB0aGUgd2F2ZWZvcm1cbiAgd2F2ZUNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIGNhbnZhc1dpZHRoLCBjYW52YXNIZWlnaHQpO1xuICB3YXZlQ29udGV4dC5iZWdpblBhdGgoKTtcbiAgd2F2ZUNvbnRleHQubGluZUpvaW4gPSBcInJvdW5kXCI7XG4gIHdhdmVDb250ZXh0LmxpbmVXaWR0aCA9IDY7XG4gIHdhdmVDb250ZXh0LnN0cm9rZVN0eWxlID0gd2F2ZWZvcm1HcmFkaWVudDtcbiAgd2F2ZUNvbnRleHQubW92ZVRvKDAsICh2YWx1ZXNbMF0gLyAyNTUpICogY2FudmFzSGVpZ2h0KTtcbiAgZm9yICh2YXIgaSA9IDEsIGxlbiA9IHZhbHVlcy5sZW5ndGg7IGkgPCBsZW47IGkrKyl7XG4gICAgdmFyIHZhbCA9ICh2YWx1ZXNbaV0gKyAxKSAvIDI7XG4gICAgdmFyIHggPSBjYW52YXNXaWR0aCAqIChpIC8gbGVuKTtcbiAgICB2YXIgeSA9IHZhbCAqIGNhbnZhc0hlaWdodDtcbiAgICB3YXZlQ29udGV4dC5saW5lVG8oeCwgeSk7XG4gIH1cbiAgd2F2ZUNvbnRleHQuc3Ryb2tlKCk7XG59XG5cbi8vZHJhd2luZyB0aGUgRkZUXG52YXIgbWV0ZXJDb250ZXh0ID0gJChcIjxjYW52YXM+XCIse1xuICBcImlkXCIgOiBcImZmdFwiXG59KS5hcHBlbmRUbyhcImJvZHlcIikuZ2V0KDApLmdldENvbnRleHQoXCIyZFwiKTtcbnZhciBtZXRlckdyYWRpZW50O1xuZnVuY3Rpb24gZHJhd01ldGVyKCl7XG4gIGNvbnN0IGxldmVsID0gbWV0ZXIuZ2V0TGV2ZWwoKTtcbiAgY29uc3QgZ2FpbiA9IFRvbmUuZGJUb0dhaW4obGV2ZWwpOyAvL3NjYWxlIGl0IGJldHdlZW4gMCAtIDFcbiAgLy8gY29uc29sZS5sb2cobGV2ZWwpO1xuICBtZXRlckNvbnRleHQuY2xlYXJSZWN0KDAsIDAsIGNhbnZhc1dpZHRoLCBjYW52YXNIZWlnaHQpO1xuICBtZXRlckNvbnRleHQuZmlsbFN0eWxlID0gbWV0ZXJHcmFkaWVudDtcbiAgbWV0ZXJDb250ZXh0LmZpbGxSZWN0KDAsIDAsIGNhbnZhc1dpZHRoLCBjYW52YXNIZWlnaHQpO1xuICBtZXRlckNvbnRleHQuZmlsbFN0eWxlID0gXCIjMjEyMTIxXCI7XG4gIG1ldGVyQ29udGV4dC5maWxsUmVjdChjYW52YXNXaWR0aCAqIGdhaW4sIDAsIGNhbnZhc1dpZHRoLCBjYW52YXNIZWlnaHQpO1xufVxuXG4vL3NpemUgdGhlIGNhbnZhc2VzXG52YXIgY2FudmFzV2lkdGgsIGNhbnZhc0hlaWdodDtcbmZ1bmN0aW9uIHNpemVDYW52YXNlcygpe1xuICBjYW52YXNXaWR0aCA9ICQoXCIjZmZ0XCIpLndpZHRoKCk7XG4gIGNhbnZhc0hlaWdodCA9ICQoXCIjZmZ0XCIpLmhlaWdodCgpO1xuICB3YXZlQ29udGV4dC5jYW52YXMud2lkdGggPSBjYW52YXNXaWR0aDtcbiAgZmZ0Q29udGV4dC5jYW52YXMud2lkdGggPSBjYW52YXNXaWR0aDtcbiAgd2F2ZUNvbnRleHQuY2FudmFzLmhlaWdodCA9IGNhbnZhc0hlaWdodDtcbiAgZmZ0Q29udGV4dC5jYW52YXMuaGVpZ2h0ID0gY2FudmFzSGVpZ2h0O1xuICBtZXRlckNvbnRleHQuY2FudmFzLndpZHRoID0gY2FudmFzV2lkdGg7XG4gIG1ldGVyQ29udGV4dC5jYW52YXMuaGVpZ2h0ID0gY2FudmFzSGVpZ2h0O1xuICAvL21ha2UgdGhlIG1ldGVyIGdyYWRpZW50XG4gIG1ldGVyR3JhZGllbnQgPSBtZXRlckNvbnRleHQuY3JlYXRlTGluZWFyR3JhZGllbnQoMCwgMCwgY2FudmFzV2lkdGgsIGNhbnZhc0hlaWdodCk7XG4gIG1ldGVyR3JhZGllbnQuYWRkQ29sb3JTdG9wKDAsIFwiIzRBMTQ4Q1wiKTtcbiAgbWV0ZXJHcmFkaWVudC5hZGRDb2xvclN0b3AoMSwgXCIjRDUwMEY5XCIpO1xuICAvL21ha2UgdGhlIGdyYWRpZW50XG4gIHdhdmVmb3JtR3JhZGllbnQgPSB3YXZlQ29udGV4dC5jcmVhdGVMaW5lYXJHcmFkaWVudCgwLCAwLCBjYW52YXNXaWR0aCwgY2FudmFzSGVpZ2h0KTtcbiAgd2F2ZWZvcm1HcmFkaWVudC5hZGRDb2xvclN0b3AoMCwgXCIjNEExNDhDXCIpO1xuICB3YXZlZm9ybUdyYWRpZW50LmFkZENvbG9yU3RvcCgxLCBcIiNENTAwRjlcIik7XG59XG5zaXplQ2FudmFzZXMoKTtcbiQod2luZG93KS5yZXNpemUoc2l6ZUNhbnZhc2VzKTtcbmZ1bmN0aW9uIGxvb3AoKXtcbiAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGxvb3ApO1xuICAvL2dldCB0aGUgZmZ0IGRhdGEgYW5kIGRyYXcgaXRcbiAgdmFyIGZmdFZhbHVlcyA9IGZmdC5nZXRWYWx1ZSgpO1xuICBkcmF3RkZUKGZmdFZhbHVlcyk7XG4gIC8vZ2V0IHRoZSB3YXZlZm9ybSB2YWx1ZXMgYW5kIGRyYXcgaXRcbiAgdmFyIHdhdmVmb3JtVmFsdWVzID0gd2F2ZWZvcm0uZ2V0VmFsdWUoKTtcbiAgZHJhd1dhdmVmb3JtKHdhdmVmb3JtVmFsdWVzKTtcblxuICBkcmF3TWV0ZXIoKTtcbn1cbmxvb3AoKTtcbiJdfQ==\n","\n//analyse the frequency/amplitude of the incoming signal\nvar fft = new Tone.FFT(1024);\n//get the waveform data for the audio\nvar waveform = new Tone.Waveform(1024);\n\n//create a level meter\nvar meter = new Tone.Meter(0.0);\n\n\n\nvar player = new Tone.Player({\n  \"url\" : \"media/all_the_stars.mp3\",\n  \"loop\" : true\n})\n.fan(fft, waveform, meter)\n.toMaster();\n\n\nconst toggleButtom = document.getElementById('btn_toggle');\ntoggleButtom.addEventListener('click',  () => {\n  player.volume.value = -12;\n  player.start();\n  player.seek(130);\n});\n\n//drawing the FFT\nvar fftContext = $(\"<canvas>\",{\n  \"id\" : \"fft\"\n}).appendTo(\"body\").get(0).getContext(\"2d\");\n\nfunction drawFFT(values){\n  fftContext.clearRect(0, 0, canvasWidth, canvasHeight);\n  var barWidth = canvasWidth / fft.size;\n  for (var i = 0, len = values.length; i < len; i++){\n    var x = canvasWidth * (i / len);\n    var y = (values[i] + 80) * 10;\n    fftContext.fillStyle = \"rgba(156, 39, 176, \" + i/len + \")\";\n    fftContext.fillRect(x, canvasHeight - y, barWidth, canvasHeight);\n  }\n}\n//the waveform data\nvar waveContext = $(\"<canvas>\", {\n  \"id\" : \"waveform\"\n}).appendTo(\"body\").get(0).getContext(\"2d\");\nvar waveformGradient;\nfunction drawWaveform(values){\n  //draw the waveform\n  waveContext.clearRect(0, 0, canvasWidth, canvasHeight);\n  waveContext.beginPath();\n  waveContext.lineJoin = \"round\";\n  waveContext.lineWidth = 6;\n  waveContext.strokeStyle = waveformGradient;\n  waveContext.moveTo(0, (values[0] / 255) * canvasHeight);\n  for (var i = 1, len = values.length; i < len; i++){\n    var val = (values[i] + 1) / 2;\n    var x = canvasWidth * (i / len);\n    var y = val * canvasHeight;\n    waveContext.lineTo(x, y);\n  }\n  waveContext.stroke();\n}\n\n//drawing the FFT\nvar meterContext = $(\"<canvas>\",{\n  \"id\" : \"fft\"\n}).appendTo(\"body\").get(0).getContext(\"2d\");\nvar meterGradient;\nfunction drawMeter(){\n  const level = meter.getLevel();\n  const gain = Tone.dbToGain(level); //scale it between 0 - 1\n  // console.log(level);\n  meterContext.clearRect(0, 0, canvasWidth, canvasHeight);\n  meterContext.fillStyle = meterGradient;\n  meterContext.fillRect(0, 0, canvasWidth, canvasHeight);\n  meterContext.fillStyle = \"#212121\";\n  meterContext.fillRect(canvasWidth * gain, 0, canvasWidth, canvasHeight);\n}\n\n//size the canvases\nvar canvasWidth, canvasHeight;\nfunction sizeCanvases(){\n  canvasWidth = $(\"#fft\").width();\n  canvasHeight = $(\"#fft\").height();\n  waveContext.canvas.width = canvasWidth;\n  fftContext.canvas.width = canvasWidth;\n  waveContext.canvas.height = canvasHeight;\n  fftContext.canvas.height = canvasHeight;\n  meterContext.canvas.width = canvasWidth;\n  meterContext.canvas.height = canvasHeight;\n  //make the meter gradient\n  meterGradient = meterContext.createLinearGradient(0, 0, canvasWidth, canvasHeight);\n  meterGradient.addColorStop(0, \"#4A148C\");\n  meterGradient.addColorStop(1, \"#D500F9\");\n  //make the gradient\n  waveformGradient = waveContext.createLinearGradient(0, 0, canvasWidth, canvasHeight);\n  waveformGradient.addColorStop(0, \"#4A148C\");\n  waveformGradient.addColorStop(1, \"#D500F9\");\n}\nsizeCanvases();\n$(window).resize(sizeCanvases);\nfunction loop(){\n  requestAnimationFrame(loop);\n  //get the fft data and draw it\n  var fftValues = fft.getValue();\n  drawFFT(fftValues);\n  //get the waveform values and draw it\n  var waveformValues = waveform.getValue();\n  drawWaveform(waveformValues);\n\n  drawMeter();\n}\nloop();\n"]}