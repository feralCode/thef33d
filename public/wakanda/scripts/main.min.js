"use strict";function drawFFT(e){fftContext.clearRect(0,0,canvasWidth,canvasHeight);for(var t=canvasWidth/fft.size,a=0,n=e.length;a<n;a++){var o=canvasWidth*(a/n),r=10*(e[a]+80);fftContext.fillStyle="rgba(156, 39, 176, "+a/n+")",fftContext.fillRect(o,canvasHeight-r,t,canvasHeight)}}function drawWaveform(e){waveContext.clearRect(0,0,canvasWidth,canvasHeight),waveContext.beginPath(),waveContext.lineJoin="round",waveContext.lineWidth=6,waveContext.strokeStyle=waveformGradient,waveContext.moveTo(0,e[0]/255*canvasHeight);for(var t=1,a=e.length;t<a;t++){var n=(e[t]+1)/2,o=canvasWidth*(t/a),r=n*canvasHeight;waveContext.lineTo(o,r)}waveContext.stroke()}function drawMeter(){var e=meter.getLevel(),t=Tone.dbToGain(e);meterContext.clearRect(0,0,canvasWidth,canvasHeight),meterContext.fillStyle=meterGradient,meterContext.fillRect(0,0,canvasWidth,canvasHeight),meterContext.fillStyle="#212121",meterContext.fillRect(canvasWidth*t,0,canvasWidth,canvasHeight)}function sizeCanvases(){canvasWidth=$("#fft").width(),canvasHeight=$("#fft").height(),waveContext.canvas.width=canvasWidth,fftContext.canvas.width=canvasWidth,waveContext.canvas.height=canvasHeight,fftContext.canvas.height=canvasHeight,meterContext.canvas.width=canvasWidth,meterContext.canvas.height=canvasHeight,meterGradient=meterContext.createLinearGradient(0,0,canvasWidth,canvasHeight),meterGradient.addColorStop(0,"#4A148C"),meterGradient.addColorStop(1,"#D500F9"),waveformGradient=waveContext.createLinearGradient(0,0,canvasWidth,canvasHeight),waveformGradient.addColorStop(0,"#4A148C"),waveformGradient.addColorStop(1,"#D500F9")}function loop(){requestAnimationFrame(loop);var e=fft.getValue();drawFFT(e);var t=waveform.getValue();drawWaveform(t),drawMeter()}var fft=new Tone.FFT(1024),waveform=new Tone.Waveform(1024),meter=new Tone.Meter(0),player=new Tone.Player({url:"media/all_the_stars.mp3",loop:!0}).fan(fft,waveform,meter).toMaster(),toggleButtom=document.getElementById("btn_toggle");toggleButtom.addEventListener("click",function(){player.volume.value=-12,player.start(),player.seek(130)});var fftContext=$("<canvas>",{id:"fft"}).appendTo("body").get(0).getContext("2d"),waveContext=$("<canvas>",{id:"waveform"}).appendTo("body").get(0).getContext("2d"),waveformGradient,meterContext=$("<canvas>",{id:"fft"}).appendTo("body").get(0).getContext("2d"),meterGradient,canvasWidth,canvasHeight;sizeCanvases(),$(window).resize(sizeCanvases),loop();
//# sourceMappingURL=main.min.js.map
